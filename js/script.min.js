var app = angular.module('Chefonia', ["ngRoute", "ngCookies"]);

app.config(['$routeProvider', '$locationProvider',
    function ($routeProvider,$locationProvider) {
        $locationProvider.hashPrefix('!');
        $locationProvider.html5Mode(false);
        $routeProvider.when('/about-us', {
            templateUrl: 'pages/about-us/about-us.html',
        }).when('/privacy', {
            templateUrl: 'pages/legal/privacy-policy.html',
        }).when('/terms', {
            templateUrl: 'pages/legal/terms.html',
        }).when('/contact-us', {
            templateUrl: 'pages/contact-us/contact-us.html',
        }).when('/register', {
            templateUrl: 'pages/register/register.html',
            controller: 'RegisterController',
            controllerAs: 'vm',
        }).when('/login', {
            templateUrl: 'pages/login/login.html',
            controller: 'LoginController',
            controllerAs: 'vm',
        }).when('/cart', {
            templateUrl: 'pages/cart/cartdetails.html',
            controller: 'CartController',
            controllerAs: 'vm',
            loginRequired: true
        }).when('/checkout', {
            templateUrl: 'pages/checkout/checkout.html',
            controller: 'CheckoutController',
            controllerAs: 'vm',
            loginRequired: true
        }).when('/item-details/:itemNumber', {
            templateUrl: 'pages/items/item-details.html',
        }).when('/item/:categoryName/:chefLocation', {
            templateUrl: 'pages/items/items.html',
            controller: 'ItemController',
            controllerAs: 'vm',
        }).when('/orderDetail/:orderId', {
            templateUrl: 'pages/orderSummary/orderSummary.html',
            controller: 'OrderSummaryController',
            controllerAs: 'vm',
            loginRequired: true
        }).when('/payu-redirect/:orderId', {
            templateUrl: 'pages/payu/payment-redirect.html',
            controller: 'PayURedirectController',
            controllerAs: 'vm',
            loginRequired: true
        }).when('/payment-failed', {
            templateUrl: 'pages/payu/payment-failed.html',
            loginRequired: true
        }).when('/login-mble', {
            templateUrl: 'pages/login/login-mble.html',
            controller: 'LoginController',
            controllerAs: 'vm',
        }).when('/orders', {
            templateUrl: 'pages/orders/orders.html',
            controller: 'OrdersController',
            controllerAs: 'vm',
            loginRequired: true
        }).when('/reset-password/:notificationId', {
            templateUrl: 'pages/common/reset-password.html',
            controller: 'ResetPasswordController',
            controllerAs: 'vm',
        }).when('/categories', {
            templateUrl: 'pages/categories/categories.html',
            controller: 'CategoryController',
            controllerAs: 'vm',
        }).otherwise({
            templateUrl: 'pages/front/front.html',
            controller: 'FrontPageController',
            controllerAs: 'vm',
        });

    }]).
    run(function ($rootScope, SessionService, $location) {
        $rootScope.$on("$routeChangeStart", function (event, next, current) {
            var isLoggedIn = SessionService.get(SessionService.Session.CurrentUser) != undefined;
            var isBagIdPresent = SessionService.get('bagId') != undefined;
            if (next.loginRequired && !isLoggedIn) {
                $location.path('home');
            }
        });

    });

app.controller('RC', function ($rootScope, $scope, $http) {
    $rootScope.homepage = true;
    $scope.chef = {};
    $scope.displayMsg = "";
    $scope.formSubmitted = false;
    $scope.submit = function () {
        $scope.formSubmitted = true;
        $scope.displayMsg = "Your request successfully submitted."
        var req = {
            method: 'POST',
            url: 'http://Chefonia.com/endpoint/db',
            headers: {
                'Content-Type': 'application/json;charset=UTF-8',
                'Authorization': 'Basic ' + "c2VjcmV0YWRtaW46cGFzc3dvcmRAY2hlZm9uaWFmb29ka2FydA=="
            },
            data: $scope.chef
        };
        try {
            $http(req).then(function (response) {
                $scope.chef = {};
                if (response.status == 201) {
                    $scope.displayMsg = "Successfully registered. We will call you soon."
                } else if (response.status == 202) {
                    $scope.displayMsg = "You are already registered with us."
                } else {
                    $scope.displayMsg = "Oops something went wrong, please try later.";
                }
            });
        } catch (err) {
            $scope.displayMsg = "Oops something went wrong, please try later.";
        }


    }

    $scope.reset = function () {
        $scope.formSubmitted = false;
        $scope.displayMsg = "";
        $scope.chef = {};
    }
    $scope.reset = function () {
        $scope.formSubmitted = false;
        $scope.displayMsg = "";
        $scope.chef = {};
    }
    animateHeader();
});

var animateHeader = function () {
    $('.heading').textillate({
        minDisplayTime: 5000,
        loop: true,
        autoStart: true,
        in: {
            effect: 'fadeInUp',
            delayScale: 1.5,
            delay: 50,
            sync: false,
            sequence: true
        },
        out: {
            effect: 'fadeInUp',
            delayScale: 1.5,
            delay: 50,
            sync: false,
            sequence: true
        }
    });
};

$(window).load(function () {
    $(".se-pre-con").fadeOut("slow");
    ;
});

Object.defineProperty(window, "console", {
    value: console,
    writable: false,
    configurable: false
});

console.log("%cStop!", "background: red; color: yellow; font-size: 70px");
console.log("%cYou are not supposed to be here. Close this window.", "font-size: 25px");